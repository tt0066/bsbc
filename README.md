# 文件说明

`main.py`：运行这个文件使后端服务器运行，运行前需要将15~19行数据库配置修改

`smartcontract.sol`：智能合约代码

`wl.py`：水印嵌入与提取需要的函数库

`require.txt`：实验需要的函数库

`templates`：html文件夹

`static`：css及js文件夹

`keys`：密钥对文件夹

`ReceiveFiles`：从网页上传，后端保存的文件

`EncryptionResult`：密文运算结果文件夹

``OfflineCode`：本地处理示例代码文件夹

# 系统运行流程

1. 运行`main.py`

2. 购买方进入前端页面注册或登录

3. 购买方进入商品购买主页

4. 购买方点击购买的商品，按要求上传四个文件：公钥、预设证据1、预设证据2、加密的水印。文件上传后将会被保存在`ReceiveFiles`文件夹中

5. 后端读取接收的公钥，加密出售的文件

6. 后端读取接收的加密的水印，用秘密参数a1,a2,a3,a4进行水印嵌入运算

   > 实验中只使用了16个数据进行加密运算作为示例

7. 后端计算完成后将结果保存在`EncryptionResult`文件夹中，然后将这个文件返回给购买方，购买方下载保存即可

上传的文件中，购买方发送的加密数据中第一项的明文为c=510.0000000000001，后端加密的数据中第一项的明文为d=649.7040244102334，实验中
参数a1=0.1,a2=0.1,a3=0.1,a4=0.1，离散小波变换水印算法嵌入形式为d=d+c X a1，运算结果约为700，请将`EncryptionResult`文件夹中文件保存的数据解密，查看第一项是否与明文运算结果一致

# 智能合约部分

* 版权方地址：0xd8585A6a60D6d293305E1947c231973d19258afc
* 购买方地址：0x26B9d156f48BD933dfc9F43130Ee7d79197C1130
* 发布的智能合约地址：0xc7c915fcc5edb2a2a40eefdb87b7367235c3d4ea
* 发布智能合约的交易哈希：0x18d1a8a52034a967fb57538ac376607404e49f6c4e3d0d88208ce3e57228a0c6
* 
